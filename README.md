# Supabase Integration Example

This project demonstrates a full Supabase integration including Authentication, Realtime (Postgres Changes), and Storage.

## Setup

1.  **Clone the repository** (if you haven't already).
2.  **Install dependencies**:
    ```bash
    npm install
    ```
3.  **Configure Environment Variables**:
    *   Create a `.env` file in the root directory (copy from `.env.example`).
    *   Add your Supabase URL and Anon Key.
    ```env
    VITE_SUPABASE_URL=your-project-url
    VITE_SUPABASE_ANON_KEY=your-anon-key
    ```
    *   **Note**: The service role key is mentioned in `.env.example` but should **ONLY** be used in server-side contexts (`src/lib/supabaseServer.js`).

## Features Implemented

*   **Authentication**:
    *   `src/components/AuthProvider.jsx`: Context provider managing user sessions.
    *   Sign in with Email/Password or Google (requires configuring Google provider in Supabase Dashboard).
*   **Realtime**:
    *   `src/components/RealtimeChat.jsx`: Subscribes to database changes on the `messages` table.
*   **Storage**:
    *   `src/components/StorageUpload.jsx`: Uploads files to a specified bucket.
*   **Server-Side Rendering (SSR) Support**:
    *   `src/lib/supabaseServer.js`: Contains helper functions (`createClient`, `createAdminClient`) using `@supabase/ssr`. These are ready to be dropped into a Next.js or Remix project for true SSR. In this Vite SPA, they serve as a reference implementation for server contexts (e.g. Edge Functions).

## Database Schema (Required for Demo)

To make the components work, run the following SQL in your Supabase SQL Editor:

```sql
-- Create a table for messages
create table messages (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  content text,
  room_id text
);

-- Enable Realtime
alter publication supabase_realtime add table messages;

-- Storage Bucket (public)
insert into storage.buckets (id, name, public) values ('public-images', 'public-images', true);

-- Policies (simplified for demo)
create policy "Public Access" on storage.objects for select using ( bucket_id = 'public-images' );
create policy "Public Upload" on storage.objects for insert with check ( bucket_id = 'public-images' );
```
